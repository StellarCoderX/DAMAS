<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Damas Aposta - Jogo Online</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />

  <!-- Importando os 3 arquivos CSS -->
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/game.css" />
  <link rel="stylesheet" href="css/tournament.css" />

  <!-- SDK Mercado Pago -->
  <script src="https://sdk.mercadopago.com/js/v2"></script>

  <style>
    /* Estilos para os blocos expans√≠veis */
    .collapsible-header {
      cursor: pointer;
      position: relative;
      user-select: none;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .collapsible-header::after {
      content: '‚ñº';
      position: absolute;
      right: 15px;
      font-size: 0.8em;
      transition: transform 0.3s;
    }

    .collapsible-header.active::after {
      transform: rotate(180deg);
    }

    .collapsible-body {
      display: none;
      /* Oculto por padr√£o */
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Novo estilo para o Cart√£o de Afiliados */
    .affiliate-card {
      background: linear-gradient(135deg, #4b2c50, #7b4397);
      /* Roxo degrad√™ */
      border: 2px solid #9b59b6;
      border-radius: 12px;
      padding: 0;
      width: 100%;
      margin-bottom: 20px;
      box-shadow: 0 5px 15px rgba(155, 89, 182, 0.2);
      overflow: hidden;
    }

    .affiliate-header {
      background: #9b59b6;
      color: white;
      font-weight: 800;
      padding: 12px;
      text-align: center;
      font-size: 1.1rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* Estilo para √°rea do QR Code */
    #qr-code-container {
      margin-top: 15px;
      text-align: center;
    }

    #qr-code-img {
      max-width: 200px;
      border: 5px solid white;
      border-radius: 8px;
      display: block;
      margin: 0 auto 15px auto;
    }

    #pix-copy-paste {
      width: 100%;
      padding: 10px;
      font-size: 0.8em;
      background: #222;
      color: #fff;
      border: 1px solid #444;
      border-radius: 4px;
      resize: none;
      height: 60px;
      margin-bottom: 10px;
    }

    /* Bot√£o de Info do Torneio */
    .info-icon {
      display: inline-block;
      width: 22px;
      height: 22px;
      background-color: rgba(255, 255, 255, 0.2);
      color: white;
      border-radius: 50%;
      text-align: center;
      line-height: 22px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      margin-left: 10px;
      position: relative;
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: background-color 0.2s;
    }

    .info-icon:hover {
      background-color: #3498db;
      border-color: #3498db;
    }
  </style>
</head>

<body>
  <div id="main-container">
    <div id="auth-container">
      <!-- BOT√ÉO DE TUTORIAL (NOVO) -->
      <button id="tutorial-btn" style="background-color: #8e44ad; margin-bottom: 15px;">
        ‚ÑπÔ∏è Como Funciona
      </button>

      <form id="login-form">
        <h2>LOGIN</h2>
        <input type="email" id="login-email" placeholder="Email" required />
        <input type="password" id="login-password" placeholder="Senha" required />
        <button type="submit">Entrar</button>
        <p>
          N√£o tem uma conta? <a href="#" id="show-register">Cadastre-se</a>
        </p>
      </form>
      <form id="register-form" style="display: none">
        <h2>Cadastro</h2>
        <input type="email" id="register-email" placeholder="Email" required />
        <input type="password" id="register-password" placeholder="Senha" required />
        <input type="text" id="referral-code-input" placeholder="C√≥digo de Indica√ß√£o (Opcional)" />
        <button type="submit">Cadastrar</button>
        <p>J√° tem uma conta? <a href="#" id="show-login">Fa√ßa Login</a></p>
      </form>
      <p id="auth-message" class="message"></p>

      <div class="app-footer">
        <p>¬© 2025 - Desenvolvido por <strong>ALVINCODER</strong></p>
        <p>Contato: <a href="https://wa.me/5571920007957" target="_blank" class="whatsapp-link">+55 71 92000-7957</a>
        </p>
      </div>
    </div>

    <div id="rules-container">
      <h2>REGRAS BRASILEIRAS</h2>
      <ul>
        <li>A captura √© Obrigat√≥ria.</li>
        <li>√â obrigado a capturar pela Lei da Maioria.</li>
        <li>Pode capturar para tr√°s.</li>
        <li>N√£o existe sopro.</li>
        <li>Pedra e Dama tem o mesmo valor para capturar e ser capturada.</li>
        <li>S√≥ de passar pela casa de cora√ß√£o a pedra N√ÉO se transforma em Dama.</li>
        <li>√â permitido passar pela mesma casa mais de uma vez na captura.</li>
        <li>N√ÉO pode capturar a mesma Pe√ßa mais de uma vez.</li>
        <li>Primeiro efetua o movimento de captura, depois retira-se as pe√ßas.</li>
        <li>O ganho acontece quando se captura todas as pe√ßas do advers√°rio ou quando o seu oponente n√£o tem onde mexer.
        </li>
      </ul>
    </div>
  </div>

  <!-- MODAL DE TUTORIAL GERAL -->
  <div id="general-tutorial-overlay" class="hidden" style="
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      z-index: 2000;
      display: flex;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(8px);
      padding: 20px;
    ">
    <div class="modal-box" style="max-width: 600px; max-height: 90vh; overflow-y: auto; text-align: left;">
      <h2
        style="color: #f1c40f; text-align: center; margin-bottom: 20px; border-bottom: 2px solid #f1c40f; padding-bottom: 10px;">
        üìñ Como Funciona o Site
      </h2>

      <div style="margin-bottom: 20px;">
        <h4 style="color: #2ecc71;">üéÆ 1. Partidas Valendo Dinheiro</h4>
        <p style="font-size: 0.9em; color: #ddd; margin-top: 5px;">
          Voc√™ pode criar ou entrar em salas de aposta. O vencedor leva o valor apostado pelo oponente (menos uma
          pequena taxa da banca, se houver).
          <br><strong>Modos:</strong> Cl√°ssico, Tablita (Sorteio de Abertura) e Internacional (10x10).
        </p>
      </div>

      <div style="margin-bottom: 20px;">
        <h4 style="color: #f39c12;">üèÜ 2. Torneio Di√°rio</h4>
        <p style="font-size: 0.9em; color: #ddd; margin-top: 5px;">
          Todos os dias √†s <strong>21:00</strong>. Inscri√ß√£o barata e pr√™mios divididos entre Campe√£o (50%) e Vice
          (30%). √â mata-mata: perdeu, saiu!
        </p>
      </div>

      <div style="margin-bottom: 20px;">
        <h4 style="color: #3498db;">üí∞ 3. Dep√≥sitos e Saques (PIX)</h4>
        <p style="font-size: 0.9em; color: #ddd; margin-top: 5px;">
          <strong>Dep√≥sito:</strong> Autom√°tico via PIX QR Code. O saldo cai na hora!<br>
          <strong>Saque:</strong> Solicite a retirada para sua chave PIX. M√≠nimo de R$ 30,00 (taxa de 30% aplicada no
          saque).
        </p>
      </div>

      <div style="margin-bottom: 20px;">
        <h4 style="color: #9b59b6;">üí∏ 4. Ganhe Indicando Amigos</h4>
        <p style="font-size: 0.9em; color: #ddd; margin-top: 5px;">
          Envie seu link de indica√ß√£o. Se seu amigo se cadastrar e fizer um primeiro dep√≥sito de pelo menos R$ 5,00,
          voc√™ ganha <strong>R$ 1,00</strong> de b√¥nus automaticamente!
        </p>
      </div>

      <div style="text-align: center; margin-top: 25px;">
        <button id="close-tutorial-btn" style="background-color: #e74c3c; width: 50%;">Fechar Tutorial</button>
      </div>
    </div>
  </div>

  <!-- ### MODAL DE PERFIL ### -->
  <div id="profile-overlay" class="hidden">
    <div class="modal-box">
      <h3>Meu Perfil</h3>
      <div style="text-align: center; margin-bottom: 20px;">
        <img id="profile-preview-img" src="" alt="Avatar"
          style="width: 80px; height: 80px; border-radius: 50%; border: 3px solid #f1c40f; object-fit: cover; background: #555;">
      </div>
      <div style="margin-bottom: 15px;">
        <label style="display: block; text-align: left; margin-bottom: 5px;">Nome de Usu√°rio (Nick):</label>
        <input type="text" id="profile-username-input" class="modal-input" placeholder="Ex: MestreDasDamas">
      </div>
      <div style="margin-bottom: 15px;">
        <label style="display: block; text-align: left; margin-bottom: 5px;">URL da Foto (Avatar):</label>
        <input type="text" id="profile-avatar-input" class="modal-input" placeholder="https://exemplo.com/foto.jpg">
        <small style="color: #aaa; display: block; text-align: left; margin-top: 2px;">Cole o link direto de uma imagem
          da internet.</small>
      </div>
      <p id="profile-message" style="min-height: 20px; font-weight: bold;"></p>
      <button id="save-profile-btn" style="background-color: #2ecc71; margin-bottom: 10px;">Salvar Altera√ß√µes</button>
      <button id="close-profile-btn" style="background-color: #e74c3c;">Fechar</button>
    </div>
  </div>

  <div id="lobby-container" class="hidden">
    <!-- ATUALIZADO: Mostra Avatar no Welcome -->
    <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 20px;">
      <img id="lobby-avatar" src="" alt="Avatar"
        style="width: 60px; height: 60px; border-radius: 50%; border: 2px solid #fff; object-fit: cover; display: none;">
      <div>
        <h2 id="lobby-welcome-message" style="margin: 0; text-align: left;"></h2>
        <button id="open-profile-btn"
          style="padding: 5px 10px; font-size: 0.8em; background-color: #34495e; margin-top: 5px; width: auto; display: inline-block;">‚úèÔ∏è
          Editar Perfil</button>
      </div>
    </div>

    <!-- ### SE√á√ÉO TORNEIO (EXPANS√çVEL) ### -->
    <div class="tournament-card">
      <div class="tournament-header collapsible-header" onclick="toggleSection(this)">
        üèÜ TORNEIO DI√ÅRIO <span id="header-participants-count"
          style="margin-left: 8px; font-size: 0.9em; opacity: 0.9;">(0)</span>
        <!-- BOT√ÉO DE INFO -->
        <span id="tournament-info-btn" class="info-icon" title="Como funciona?">?</span>
      </div>
      <div class="tournament-body collapsible-body">
        <p>‚è∞ In√≠cio: <strong>21:00</strong> (Todo dia)</p>
        <p>üí∞ Inscri√ß√£o: <strong>R$ 2,00</strong></p>
        <p>üë• M√≠nimo: 8 Jogadores</p>
        <hr style="border-color: rgba(255,255,255,0.1);">
        <p>üéÅ Pr√™mios (do Total Arrecadado):</p>
        <ul style="list-style: none; padding: 0; font-size: 0.9em; color: #f1c40f;">
          <li>ü•á Campe√£o: 50%</li>
          <li>ü•à Vice: 30%</li>
          <li>üè¶ Banca: 20%</li>
        </ul>

        <div id="tournament-status-area" style="margin-top: 15px;">
          <p id="trn-participants-count">Inscritos: 0</p>
          <p id="trn-prize-pool">Pr√™mio Atual: R$ 0,00</p>

          <div style="display: flex; gap: 10px; justify-content: center;">
            <button id="join-tournament-btn" class="gold-btn">Inscrever-se (R$ 2,00)</button>
            <!-- NOVO BOT√ÉO DE SAIR -->
            <button id="leave-tournament-btn" class="red-btn hidden"
              style="width: 100%; max-width: 250px; margin-top: 10px;">Remover Inscri√ß√£o</button>
          </div>

          <p id="trn-message" style="font-size: 0.8em; margin-top: 5px; min-height: 1.2em;"></p>
        </div>
      </div>
    </div>

    <!-- ### SE√á√ÉO AFILIADOS (NOVO BLOCO EXPANS√çVEL) ### -->
    <div class="affiliate-card">
      <div class="affiliate-header collapsible-header" onclick="toggleSection(this)">
        üí∏ SISTEMA DE INDICA√á√ÉO üí∏
      </div>
      <div class="collapsible-body" style="padding: 15px; text-align: center;">
        <p style="font-size: 0.9em; margin-bottom: 10px; color: #f0f0f0;">
          Ganhe <strong>R$ 1,00</strong> de b√¥nus sempre que um amigo indicado fizer o primeiro dep√≥sito de R$ 5,00 ou
          mais!
        </p>
        <button id="copy-referral-btn"
          style="background-color: #8e44ad; font-size: 0.9em; padding: 10px; margin-bottom: 5px; width: 100%;">Copiar
          Link de Indica√ß√£o</button>
        <button id="view-referrals-btn"
          style="background-color: #9b59b6; font-size: 0.9em; padding: 10px; width: 100%;">Minhas Indica√ß√µes</button>
        <button id="view-history-btn"
          style="background-color: #34495e; font-size: 0.9em; padding: 10px; margin-top: 5px; width: 100%;">üìú
          Hist√≥rico de Partidas</button>
      </div>
    </div>

    <button id="add-balance-btn">Adicionar Saldo (Autom√°tico)</button>

    <button id="withdraw-btn" style="background-color: #2ecc71;">Retirar Saldo</button>

    <a href="https://chat.whatsapp.com/IhFRzg8Bt89JhacRTdySUN?mode=wwt" id="whatsapp-group-btn" target="_blank">Entrar
      no Grupo do WhatsApp</a>
    <button id="logout-btn" style="background-color: #c0392b; margin-bottom: 20px">
      Sair
    </button>

    <div class="lobby-section" id="create-room-section">
      <h3>Criar uma nova partida</h3>
      <input type="number" id="bet-amount-input" placeholder="Valor da Aposta" min="1" value="1" />
      <div id="game-mode-selection" style="
            margin-top: 10px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
          ">
        <label for="game-mode-select">Modo de Jogo:</label>
        <select id="game-mode-select" style="
              padding: 5px;
              border-radius: 4px;
              border: 1px solid #ccc;
              background-color: #f0f0f0;
            ">
          <option value="classic">Cl√°ssico 8x8</option>
          <option value="tablita">Tablita 8x8</option>
          <option value="international">Internacional 10x10</option>
        </select>
      </div>

      <div id="time-control-selection" style="
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
          ">
        <label for="time-control-select">Tipo de Tempo:</label>
        <select id="time-control-select" style="
              padding: 5px;
              border-radius: 4px;
              border: 1px solid #ccc;
              background-color: #f0f0f0;
            ">
          <option value="move">Por Jogada (Padr√£o)</option>
          <option value="match">Por Partida (Blitz)</option>
        </select>
      </div>

      <div id="timer-selection-container" style="
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
          ">
        <label for="timer-select">Tempo por Jogada:</label>
        <select id="timer-select" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc">
        </select>
      </div>

      <button id="create-room-btn">Criar Sala</button>
    </div>

    <div id="waiting-area" class="hidden">
      <p>A aguardar por um oponente...</p>
      <p>A sua sala est√° vis√≠vel para outros jogadores no lobby.</p>
      <button id="cancel-room-btn" style="background-color: #c0392b; margin-top: 10px">
        Cancelar
      </button>
      <strong id="room-code-display" style="display: none"></strong>
    </div>

    <div class="lobby-section" id="open-rooms-section">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <h3>Salas Abertas</h3>
        <button id="refresh-lobby-btn"
          style="width: auto; padding: 5px 10px; font-size: 0.8em; background-color: #3498db;">Atualizar üîÑ</button>
      </div>
      <div id="open-rooms-list">
        <p>A carregar salas...</p>
      </div>
    </div>

    <div class="lobby-section" id="active-rooms-section" style="margin-top: 20px;">
      <h3>Jogos em Andamento (Assistir)</h3>
      <div id="active-rooms-list">
        <p>Nenhum jogo em andamento.</p>
      </div>
    </div>

    <p id="lobby-error-message" class="error-message"></p>

    <div class="app-footer">
      <p>¬© 2025 - Desenvolvido por <strong>ALVINCODER</strong></p>
      <p>Contato: <a href="https://wa.me/5571920007957" target="_blank" class="whatsapp-link">+55 71 92000-7957</a></p>
    </div>
  </div>

  <div id="game-container" class="hidden">
    <div id="spectator-indicator" class="hidden"
      style="background-color: #f39c12; color: #fff; padding: 5px 10px; border-radius: 5px; margin-bottom: 10px; font-weight: bold;">
      üëÄ MODO ESPECTADOR
    </div>

    <div id="tournament-indicator" class="hidden"
      style="background-color: #9b59b6; color: #fff; padding: 5px 10px; border-radius: 5px; margin-bottom: 10px; font-weight: bold;">
      üèÜ PARTIDA DE TORNEIO
    </div>

    <div id="players-hud" class="players-hud hidden">
      <div class="player-badge white-player">
        <div class="piece-icon white-piece-icon"></div>
        <!-- AVATAR NO JOGO -->
        <img id="white-player-avatar" src="" class="hidden"
          style="width:30px; height:30px; border-radius:50%; margin-right:5px; object-fit:cover;">
        <span id="white-player-name">Jogador 1</span>
      </div>
      <div class="vs-badge">VS</div>
      <div class="player-badge black-player">
        <!-- AVATAR NO JOGO -->
        <img id="black-player-avatar" src="" class="hidden"
          style="width:30px; height:30px; border-radius:50%; margin-right:5px; object-fit:cover;">
        <div class="piece-icon black-piece-icon"></div>
        <span id="black-player-name">Jogador 2</span>
      </div>
    </div>

    <p id="game-status"></p>
    <div id="board"></div>
    <div id="game-info">
      <p>Vez de: <span id="turn">Brancas</span></p>
      <p>Tempo restante: <span id="timer">40</span>s</p>
      <div id="game-buttons">
        <button id="resign-btn">Desistir</button>
        <button id="draw-btn">Empate</button>
        <button id="spectator-leave-btn" class="hidden" style="background-color: #c0392b;">Sair do Jogo</button>
      </div>
    </div>
  </div>

  <!-- MODAL DE TORNEIO (MATA-MATA) -->
  <div id="tournament-bracket-overlay" class="hidden">
    <div class="modal-box" style="max-width: 95%; max-height: 90vh; overflow-y: auto;">
      <h3>üèÜ Chaveamento do Torneio</h3>
      <p id="tournament-round-display">Oitavas de Final</p>
      <div id="tournament-matches-list" style="margin: 20px 0; display: flex; flex-direction: column; gap: 10px;">
        <!-- Preenchido via JS -->
      </div>
      <p id="tournament-wait-message" style="color: #f1c40f;">Aguardando in√≠cio das partidas...</p>
      <button id="close-bracket-btn" style="background-color: #e74c3c;">Fechar</button>
    </div>
  </div>

  <!-- NOVO: MODAL DE INFORMA√á√ïES DO TORNEIO -->
  <div id="tournament-info-overlay" class="hidden">
    <div class="modal-box" style="text-align: left; max-width: 450px;">
      <h3 style="color: #f1c40f; text-align: center; margin-bottom: 20px;">‚ÑπÔ∏è Como Funciona o Torneio</h3>
      <ul style="font-size: 0.9em; line-height: 1.6; color: #ecf0f1; padding-left: 20px; list-style-type: disc;">
        <li style="margin-bottom: 8px;"><strong>‚è∞ Hor√°rio:</strong> O torneio inicia pontualmente √†s 21:00 (Hor√°rio de
          Bras√≠lia).</li>
        <li style="margin-bottom: 8px;"><strong>‚öîÔ∏è Formato Mata-Mata:</strong> √â simples: quem perde, sai. Quem ganha,
          avan√ßa para a pr√≥xima fase.</li>
        <li style="margin-bottom: 8px;"><strong>üí∞ Inscri√ß√£o:</strong> O valor da inscri√ß√£o √© descontado automaticamente
          do seu saldo ao entrar.</li>
        <li style="margin-bottom: 8px;"><strong>üë• M√≠nimo de Jogadores:</strong> O torneio s√≥ come√ßa se houver pelo
          menos 8 inscritos online na hora marcada.</li>
        <li style="margin-bottom: 8px;"><strong>üèÜ Premia√ß√£o:</strong> O pr√™mio total arrecadado √© dividido: 50% para o
          Campe√£o e 30% para o Vice.</li>
        <li style="margin-bottom: 8px;"><strong>‚Ü©Ô∏è Reembolso:</strong> Se o torneio for cancelado por falta de qu√≥rum, o
          valor da inscri√ß√£o √© devolvido integralmente para sua conta.</li>
        <li><strong>‚ö†Ô∏è W.O.:</strong> Se o seu oponente n√£o aparecer ou cair, voc√™ vence automaticamente.</li>
      </ul>
      <button id="close-tournament-info-btn" style="background-color: #3498db; margin-top: 20px;">Entendi, Vamos
        Jogar!</button>
    </div>
  </div>

  <div id="game-over-overlay" class="hidden">
    <div id="winner-screen" class="hidden">
      <div class="firework"></div>
      <div class="firework"></div>
      <div class="firework"></div>
      <h1>Parab√©ns, Voc√™ Ganhou!</h1>
      <p class="revanche-status"></p>
      <div class="confirm-buttons">
        <button class="revanche-btn">Revanche</button>
        <button class="exit-lobby-btn">Voltar √† Tela Principal</button>
      </div>
    </div>
    <div id="loser-screen" class="hidden">
      <div class="emoji">üò¢</div>
      <h1>Voc√™ Perdeu</h1>
      <p class="revanche-status"></p>
      <div class="confirm-buttons">
        <button class="revanche-btn">Revanche</button>
        <button class="exit-lobby-btn">Voltar √† Tela Principal</button>
      </div>
    </div>
    <div id="draw-screen" class="hidden">
      <h1>Empate!</h1>
      <p id="draw-reason"></p>
      <p class="revanche-status"></p>
      <div class="confirm-buttons">
        <button class="revanche-btn">Revanche</button>
        <button class="exit-lobby-btn">Voltar √† Tela Principal</button>
      </div>
    </div>
    <div id="spectator-end-screen" class="hidden"
      style="background-color: #2c3e50; color: white; padding: 40px; border-radius: 15px; text-align: center; border: 5px solid #3498db;">
      <h1>Fim de Jogo</h1>
      <p id="spectator-end-message"></p>
      <div class="confirm-buttons">
        <button class="exit-lobby-btn" style="background-color: #3498db;">Voltar ao Lobby</button>
      </div>
    </div>
  </div>

  <div id="confirm-bet-overlay" class="hidden">
    <div id="confirm-bet-box">
      <h3>Confirmar Aposta</h3>
      <p>
        A aposta para esta sala √© de
        <strong id="confirm-bet-amount"></strong> cr√©ditos.
      </p>
      <p id="confirm-game-mode" style="font-weight: bold; margin-top: 10px"></p>
      <p>Voc√™ aceita?</p>
      <div class="confirm-buttons">
        <button id="accept-bet-btn">Aceitar</button>
        <button id="decline-bet-btn">Recusar</button>
      </div>
    </div>
  </div>
  <div id="connection-lost-overlay" class="hidden">
    <div id="connection-lost-box">
      <h3>Conex√£o Inst√°vel</h3>
      <p id="connection-lost-message"></p>
      <div class="loader"></div>
    </div>
  </div>
  <div id="next-game-overlay" class="hidden">
    <div id="next-game-box">
      <h2 id="next-game-title">Fim da 1¬™ Partida!</h2>
      <p id="match-score-display" style="font-size: 1.2em; margin: 15px 0"></p>
      <p>A 2¬™ partida come√ßar√° com as cores invertidas...</p>
      <p style="margin-top: 15px">
        A iniciar em <span id="next-game-timer">10</span>s
      </p>
    </div>
  </div>

  <div id="draw-request-overlay" class="hidden">
    <div id="draw-request-box">
      <h3>Pedido de Empate</h3>
      <p>O seu oponente prop√¥s um empate. Voc√™ aceita?</p>
      <div class="confirm-buttons">
        <button id="accept-draw-btn">Aceitar</button>
        <button id="decline-draw-btn">Recusar</button>
      </div>
    </div>
  </div>

  <!-- ### ALTERADO: Modal de Dep√≥sito com QR Code ### -->
  <div id="pix-overlay" class="hidden">
    <div class="modal-box">
      <h3>Recarga Autom√°tica (PIX)</h3>
      <p>O saldo cai na hora!</p>

      <div style="margin: 20px 0;">
        <label for="deposit-amount" style="display: block; margin-bottom: 5px; color: #ccc;">Valor (R$):</label>
        <input type="number" id="deposit-amount" class="modal-input" placeholder="Ex: 10.00" min="1" step="0.01"
          value="5.00">
      </div>

      <button id="pay-mercadopago-btn" style="background-color: #009ee3; font-weight: bold; margin-bottom: 15px;">
        Gerar QR Code PIX
      </button>

      <div id="mp-loading" class="hidden" style="margin-bottom: 10px;">
        <div class="loader" style="width: 20px; height: 20px; border-width: 2px;"></div>
        <p style="font-size: 0.8em;">Gerando pagamento...</p>
      </div>

      <!-- √ÅREA PARA O QR CODE (Invis√≠vel at√© gerar) -->
      <div id="qr-code-container" class="hidden">
        <p style="color: #2ecc71; font-weight: bold; margin-bottom: 10px;">Escaneie ou Copie:</p>
        <img id="qr-code-img" src="" alt="QR Code PIX">
        <textarea id="pix-copy-paste" readonly></textarea>
        <button id="copy-pix-code-btn" style="background-color: #f1c40f; color: #2c3e50;">Copiar C√≥digo</button>
      </div>

      <p class="instructions" style="font-size: 0.8em; color: #aaa; margin-top: 10px;">
        Ap√≥s pagar, o saldo ser√° adicionado automaticamente em alguns segundos. N√£o feche esta janela at√© confirmar.
      </p>

      <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.1); margin: 15px 0;">

      <p style="font-size: 0.8em;">Problemas? Envie o comprovante:</p>
      <a href="#" id="send-proof-btn" target="_blank" class="whatsapp-link">Falar no WhatsApp</a>

      <button id="close-pix-overlay-btn">Fechar</button>
    </div>
  </div>

  <div id="withdraw-overlay" class="hidden">
    <div class="modal-box">
      <h3>Solicitar Retirada</h3>
      <p>Preencha os dados para receber seu saldo via PIX.</p>
      <p style="color: #f39c12; font-size: 0.9em; margin-bottom: 5px;">‚ö†Ô∏è O valor m√≠nimo para retirada √© de <strong>R$
          30,00</strong>.</p>
      <!-- AVISO DE TAXA ADICIONADO -->
      <p style="color: #e74c3c; font-size: 0.9em; margin-bottom: 10px;">‚ö†Ô∏è Taxa de saque: <strong>30%</strong> do valor
        solicitado ser√° descontado.</p>

      <form id="withdraw-form" style="display: flex; flex-direction: column; gap: 10px;">
        <input type="text" id="withdraw-pix-key" placeholder="Sua Chave PIX" required class="modal-input">
        <input type="number" id="withdraw-amount" placeholder="Valor (R$)" min="30" required class="modal-input">
        <button type="submit" style="background-color: #2ecc71; margin-top: 10px;">Solicitar</button>
      </form>

      <p id="withdraw-message" style="margin-top: 10px; font-weight: bold;"></p>
      <button id="close-withdraw-overlay-btn">Fechar</button>
    </div>
  </div>

  <div id="referrals-overlay" class="hidden">
    <div class="modal-box">
      <h3>Minhas Indica√ß√µes</h3>
      <p>Pessoas que se cadastraram com seu link.</p>

      <div id="referrals-list"
        style="margin-top: 15px; max-height: 200px; overflow-y: auto; text-align: left; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 5px;">
        <p>Carregando...</p>
      </div>

      <button id="close-referrals-overlay-btn">Fechar</button>
    </div>
  </div>

  <div id="history-overlay" class="hidden">
    <div class="modal-box" style="max-width: 600px;">
      <h3>Hist√≥rico de Partidas</h3>
      <div id="history-list"
        style="margin-top: 15px; max-height: 400px; overflow-y: auto; text-align: left; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 5px;">
        <p>Carregando...</p>
      </div>
      <button id="close-history-overlay-btn">Fechar</button>
    </div>
  </div>

  <audio id="move-sound" src="/sounds/move.mp3" preload="auto"></audio>
  <audio id="capture-sound" src="/sounds/capture.mp3" preload="auto"></audio>
  <!-- NOVO: Som de entrada na sala (usando move.mp3 como padr√£o, altere para join.mp3 se tiver o ficheiro) -->
  <audio id="join-sound" src="/entrada/move.mp3" preload="auto"></audio>

  <!-- Script para alternar visibilidade (Acorde√£o) -->
  <script>
    function toggleSection(headerElement) {
      const body = headerElement.nextElementSibling;
      headerElement.classList.toggle("active");
      if (body.style.display === "block") {
        body.style.display = "none";
      } else {
        body.style.display = "block";
      }
    }

    // --- SCRIPT PARA O MODAL DE TUTORIAL ---
    document.addEventListener("DOMContentLoaded", () => {
      const tutorialBtn = document.getElementById("tutorial-btn");
      const tutorialOverlay = document.getElementById("general-tutorial-overlay");
      const closeTutorialBtn = document.getElementById("close-tutorial-btn");

      if (tutorialBtn && tutorialOverlay && closeTutorialBtn) {
        tutorialBtn.addEventListener("click", () => {
          tutorialOverlay.classList.remove("hidden");
        });

        closeTutorialBtn.addEventListener("click", () => {
          tutorialOverlay.classList.add("hidden");
        });

        // Fechar ao clicar fora
        tutorialOverlay.addEventListener("click", (e) => {
          if (e.target === tutorialOverlay) {
            tutorialOverlay.classList.add("hidden");
          }
        });
      }
    });
  </script>

  <script src="/socket.io/socket.io.js"></script>

  <!-- CORRE√á√ÉO: Caminhos apontando para a pasta js/ -->
  <script src="js/gameLogic.js"></script>
  <script src="js/ui-helpers.js"></script>
  <script src="js/lobby.js"></script>
  <script src="js/script.js"></script>
</body>

</html>